appId: com.electrum.app
---
# Web Auth Tests
# Orchestrates all web authentication test scenarios

# ===========================
# Scenario 1: Successful Login (Seeded User)
# ===========================
- runFlow: ../../common/auth-setup.yaml

- tapOn:
    text: ".*Login email.*"
- inputText: "ahmad.mukhlish.saputra@gmail.com"

- tapOn:
    text: ".*Login password.*"
- inputText: "CobaCoba123"

- tapOn:
    text: ".*Login button.*"

- waitForAnimationToEnd

# Assert: Successfully logged in (sidebar visible)
- assertVisible:
    text: ".*Home sidebar.*"

# Assert: No error snackbar
- assertNotVisible:
    text: ".*Error snackbar.*"

# ===========================
# Scenario 2: Failed Login (Random Credentials)
# ===========================
- runFlow: ../../common/auth-setup.yaml

- tapOn:
    text: ".*Login email.*"
- inputText: "random_${CURRENT_TIME}@example.com"

- tapOn:
    text: ".*Login password.*"
- inputText: "RandomPassword123"

- tapOn:
    text: ".*Login button.*"

- waitForAnimationToEnd

# Assert: Error snackbar is visible
- assertVisible:
    text: ".*Error snackbar.*"

# Assert: Still on login screen
- assertVisible:
    text: ".*Login button.*"

# Assert: Sidebar NOT visible
- assertNotVisible:
    text: ".*Home sidebar.*"

# ===========================
# Scenario 3: Successful Registration (Random Credentials)
# ===========================
- runFlow: ../../common/auth-setup.yaml

# Navigate to register screen
- tapOn:
    text: ".*Login signup.*"

- waitForAnimationToEnd

# Fill registration form with random credentials
- tapOn:
    text: ".*Register email.*"
- inputText: "test_${CURRENT_TIME}@example.com"

- tapOn:
    text: ".*Register password.*"
- inputText: "TestPassword123"

- tapOn:
    text: ".*Register button.*"

- waitForAnimationToEnd

# Assert: Successfully registered and logged in
- assertVisible:
    text: ".*Home sidebar.*"

# Assert: No error snackbar
- assertNotVisible:
    text: ".*Error snackbar.*"

# ===========================
# Scenario 4: Failed Registration (Existing User)
# ===========================
- runFlow: ../../common/auth-setup.yaml

# Navigate to register screen
- tapOn:
    text: ".*Login signup.*"

- waitForAnimationToEnd

# Try to register with existing credentials
- tapOn:
    text: ".*Register email.*"
- inputText: "ahmad.mukhlish.saputra@gmail.com"

- tapOn:
    text: ".*Register password.*"
- inputText: "CobaCoba123"

- tapOn:
    text: ".*Register button.*"

- waitForAnimationToEnd

# Assert: Error snackbar is visible
- assertVisible:
    text: ".*Error snackbar.*"

# Assert: Still on register screen
- assertVisible:
    text: ".*Register button.*"

# Assert: Sidebar NOT visible
- assertNotVisible:
    text: ".*Home sidebar.*"

# ===========================
# Scenario 5: Logout Flow
# ===========================

# First, login if not already logged in
- runFlow: ../../common/auth-setup.yaml

- tapOn:
    text: ".*Login email.*"
- inputText: "ahmad.mukhlish.saputra@gmail.com"

- tapOn:
    text: ".*Login password.*"
- inputText: "CobaCoba123"

- tapOn:
    text: ".*Login button.*"

- waitForAnimationToEnd

# Assert: Successfully logged in
- assertVisible:
    text: ".*Home sidebar.*"

# Navigate to Profile
- tapOn:
    text: "Profile"

- waitForAnimationToEnd

# Tap logout button
- tapOn:
    text: ".*Logout button.*"

- waitForAnimationToEnd

# Assert: Back to login screen
- assertVisible:
    text: ".*Login image.*"
- assertVisible:
    text: ".*Login email.*"
- assertVisible:
    text: ".*Login password.*"
- assertVisible:
    text: ".*Login button.*"

# Assert: Sidebar NOT visible
- assertNotVisible:
    text: ".*Home sidebar.*"
